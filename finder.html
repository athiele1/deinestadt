<html>
<head>
<link rel="shortcut icon" type="image/png" href="pics/logo_300.png"/>
<title>Bremen spendet</title>
<meta charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="style.css">
<link href="https://fonts.googleapis.com/css?family=Oswald:400" rel="stylesheet">
<script src="main.js"></script>
</head>
<body>
<!--
<div class="introDivNO"><div class="introDivImageNO"><img src="pics/logo_200.png" width="100px" height="100px"></div></div>
-->
<div id="divHead">
<div id="SocialLinks">
                <p>  <a  href="https://www.facebook.com/bremenspendet/" target="_blank"><img src="pics/facebook.svg" width="40" height="40"></a>
                    <a href="https://www.instagram.com/bremenspendet/" target="_blank"><img src="pics/instagram.svg" width="40" height="40"></a></p> 
            </div></div>
 <div id="divContent">
  <h1 style="font-family: 'Roboto', sans-serif;">Was möchtest Du spenden?</h1>
  <div id="divKat"></div>
  <h1>Deine Postleitzahl:</h1>
  <input type="text"  style="width:80px" id="plzInput" class="noFocus" oninput="plzCheck(this)" max = "99999" maxLength="5" onKeyPress="return isNumeric(event)">
  <span id="plzFound" style="color:green"></span>
  <br><br>
  <input type="button" id="los" class="losbutton1" value="Los!" onClick="los()">
  <br>
  <br>
  <!--<h1>Der "Spenden-Finder" ist noch in Arbeit.</h1>
    
    <div id="div350">
    <img src="pics/tea.png" width="350" height="260">
    Bis dahin heißt es abwarten und Spenden raussuchen.
    </div>-->
  
  <div id="map"></div>
</div>
<div id="divButtom"></div>
</body>
<script>
	
	
	
    addHeadMenu(document.getElementById("divHead"));
    addButtomMenu(document.getElementById("divButtom"));
    markButton(1);
    
	

	for(var i = 0; i < katLabels.length; i++){
		addKategorie(katLabels[i],katPaths[i]);
			
	}
	
	//Alle "Stadtteile", also PLZ plus Position
	var stadtteile = [];
	addAllPLZ();
	
	
	
	
	//"Klasse" für Stadteil
 	function Stadtteil(pplz, plgrad, pbgrad){
		this.plz = pplz;
		this.lgrad = plgrad;
		this.bgrad = pbgrad;
	}
	
	//Fügt Stadtteil hinzu
	function addStadtTeil(plz, lgrad, bgrad){
		
		var si = new Stadtteil(plz, lgrad, bgrad);

		stadtteile.push(si);
	}
	
	//Sobald der Knopf Los gedrückt wird
	function los(){
		
		var plzInput = document.getElementById("plzInput");
		var si = plzToStadtteil(plzInput.value);
		
		if(si != null){
			map.setZoom(13);
			map.setCenter(new google.maps.LatLng(si.lgrad, si.bgrad));	
			
			
		}
		window.scrollTo(0,document.body.scrollHeight);
		updateMarkers(true);
		
	}
	
	//Wandelt eine PLZ zum Stadteil um
	function plzToStadtteil(plz){
		var s = plz.toString();
	
		for(i in stadtteile){
			if(s == stadtteile[i].plz.toString()){
				return 	stadtteile[i];
			}
		}
		
		return null;
	}
	
	
	

	
	//Ersellt die klickbaren Kategorien Auswahlboxen
	function addKategorie(name, pfad){
	
		var nr = kategorien.length;
		
		
		var img = new Image();
		img.src = pfad;
		
		var btn = document.createElement("a");
		btn.name = name;
		btn.href = "JavaScript:clickKategorie(" + nr + ");";
		btn.className = "noFocus";
		
		img.id = "img_" + nr;
		img.className = "katImg";
		
		kategorien.push(false);
		
		
		btn.appendChild(img);
		
		
		
		var div = document.createElement("div");
		//div.className = "noFocus";
		
		div.className = "katDiv";
		
		var txt = document.createTextNode(name);
		//txt.style.textAlign = "center";		
		
		
		
		div.appendChild(btn);
		div.appendChild(txt);
		document.getElementById("divKat").appendChild(div);	
	}
	
	//Sobald eine Kategorie angedrückt wird, wechselt Umrahmung, setz den Bool in kategorien[]
	function clickKategorie(nr){
		var img = document.getElementById("img_" + nr);
		var pfad = img.src.substring(0,img.src.length-4);
		kategorien[nr] = !kategorien[nr];
		
		
		if(kategorien[nr]){
			img.src = pfad + "_2.png";
			
		}else{
			img.src = pfad.substring(0,pfad.length-2) + ".png";
			
		}
	}
	
	
	 
	 //Checkt die Eingabe des PLZ Eingabefelds
	 //src: https://stackoverflow.com/questions/8354975/how-can-i-limit-possible-inputs-in-a-html5-number-element
	function plzCheck(object) {
    if (object.value.length > object.maxLength){
		object.value = object.value.slice(0, object.maxLength);
	}
	var plzFound = document.getElementById("plzFound");
	
	if(plzToStadtteil(object.value) != null){
		plzFound.innerHTML = "✔";
	}else{
		plzFound.innerHTML = "";
	}
	
	
  }
    
  function isNumeric (evt) {
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
	
	//Lösch,entfern, und pfeiltasten 
	if(key == 8 || key == 46 || key == 39 || key == 37){
		return;	
	}
	
    key = String.fromCharCode (key);
	
    var regex = /[0-9]|\./;
    if ( !regex.test(key) ) {
      theEvent.returnValue = false;
      if(theEvent.preventDefault) theEvent.preventDefault();
    }
  }
  
  
 function addAllPLZ(){
	addStadtTeil(28717,53.170694,8.686246);
	addStadtTeil(28719,53.154667,8.701797);
	addStadtTeil(28237,53.122292,8.730002);
	addStadtTeil(28239,53.135102,8.739511);
	addStadtTeil(28357,53.127528,8.864201);
	addStadtTeil(28197,53.096194,8.713175);
	addStadtTeil(28219,53.111571,8.791184);
	addStadtTeil(28359,53.103984,8.861513);
	addStadtTeil(28355,53.097650,8.932582);
	addStadtTeil(28217,53.094305,8.773924);
	addStadtTeil(28215,53.097407,8.809555);
	addStadtTeil(28213,53.096262,8.844588);
	addStadtTeil(28195,53.080842,8.804617);
	addStadtTeil(28209,53.087569,8.828092);
	addStadtTeil(28203,53.074142,8.824178);
	addStadtTeil(28211,53.083145,8.852693);
	addStadtTeil(28205,53.069402,8.844003);
	addStadtTeil(28207,53.065793,8.866263);
	addStadtTeil(28329,53.078580,8.882541);
	addStadtTeil(28327,53.074643,8.921057);
	addStadtTeil(28325,53.068635,8.948931);
	addStadtTeil(28201,53.059496,8.814182);
	addStadtTeil(28259,53.055231,8.736066);
	addStadtTeil(28199,53.060853,8.784807);
	addStadtTeil(28277,53.038870,8.818319);
	addStadtTeil(28279,53.039011,8.849759);
	addStadtTeil(28309,53.044937,8.889094);
	addStadtTeil(28307,53.037959,8.928469);
	addStadtTeil(28777,53.206085,8.525941);
	addStadtTeil(28779,53.193830,8.573819);
	addStadtTeil(28755,53.184524,8.611530);
	addStadtTeil(28757,53.177439,8.632339);
	addStadtTeil(28759,53.167725,8.650905);
}
	 
	 
	 
         </script>

 <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiCHKIxpj5H2bfsFK5VRYI5al3r9ira2E&callback=initMap&libraries=places">
        </script>

</html>