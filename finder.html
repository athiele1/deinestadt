<html>
<head>
<link rel="shortcut icon" type="image/png" href="pics/logo_300.png"/>
<title>Bremen spendet</title>
<meta charset="utf-8"/>
<link rel="stylesheet" type="text/css" href="style.css">
<link href="https://fonts.googleapis.com/css?family=Oswald:400" rel="stylesheet">
<script src="main.js"></script>
</head>
<body>
<div id="divHead"></div>
<div id="divContent">
  <h1>Was möchtest du spenden?</h1>
  
  <div id="divKat"></div>
  
  <h1>Deine Postleitzahl:</h1>
  <input type="number"  class="noFocus" oninput="maxLengthCheck(this)" max = "99999" maxLength="5" onKeyPress="return isNumeric(event)">
  
  
  <input type="button" value="Los!">
  <br>
  <br>
  <!--<h1>Der "Spenden-Finder" ist noch in Arbeit.</h1>
    
    <div id="div350">
    <img src="pics/tea.png" width="350" height="260">
    Bis dahin heißt es abwarten und Spenden raussuchen.
    </div>-->
  
  <div id="map"></div>
</div>
<div id="divButtom"></div>
</body>
<script>
    var infowindow,service,map;
	var kategorien = [];
	
    addHeadMenu(document.getElementById("divHead"));
    addButtomMenu(document.getElementById("divButtom"));
    markButton(1);
    
	
	var katLabels = ["Bücher","Elektronik","Spielzeug","Haushaltsgeräte","Kleidung"];
	var katPaths = ["buch","elektronik","spielzeug","haushalt","kleidung"];
	
	for(var i = 0; i < katPaths.length; i++){
		katPaths[i] = 	pathLabelToPath(katPaths[i]);		
	}
	
	for(var i = 0; i < katLabels.length; i++){
		addKategorie(katLabels[i],katPaths[i]);
			
	}
	
	function pathLabelToPath(katPath){
		return 	"pics/finder/c_" + katPath + ".png";
		
	}
	
	
	
	function addKategorie(name, pfad){
	
		var nr = kategorien.length;
		
		
		var img = new Image();
		img.src = pfad;
		
		var btn = document.createElement("a");
		btn.name = name;
		btn.href = "JavaScript:clickKategorie(" + nr + ");";
		btn.className = "noFocus";
		
		img.id = "img_" + nr;
		kategorien.push(false);
		
		
		btn.appendChild(img);
		
		
		
		var div = document.createElement("div");
		//div.className = "noFocus";
		
		div.style.width = "120px";
		div.style.height = "90px";
		div.style.margin = "5px";
		div.style.marginBottom = "20px";
		div.style.textAlign = "center";
		
		//div.style.background = "red";
		div.style.display = "inline-block"
		
		var txt = document.createTextNode(name);
		//txt.style.textAlign = "center";		
		
		
		
		div.appendChild(btn);
		div.appendChild(txt);
		document.getElementById("divKat").appendChild(div);	
	}
	
	function clickKategorie(nr){
		var img = document.getElementById("img_" + nr);
		var pfad = img.src.split(".");
		kategorien[nr] = !kategorien[nr];
		
		
		if(kategorien[nr]){
			img.src = pfad[0] + "_2." + pfad[1];
			
		}else{
			img.src = pfad[0].substring(0,pfad[0].length-2) + "." + pfad[1];
			
		}
	}
	
	
	
	
	
	
	//Anleitungen/hilfstools:
	
	//https://developers.google.com/places/place-id#find-id
	//https://developers.google.com/maps/documentation/javascript/examples/place-details?hl=de
	
	function addPlace2(name, spendenAnnahmen, bGrad, lGrad, adresse){
	
		var pos = {lat: bGrad, lng: lGrad};
	
		var marker = new google.maps.Marker({
             map: map,
             position: pos
        });
			
      	google.maps.event.addListener(marker, 'click', function() {
			
			var content = '<div><strong>' + name + '</strong><br>';
			
			for(h in spendenAnnahmen){
				for(var i = 0; i < katLabels.length; i++){
					
					if(spendenAnnahmen[h] === katLabels[i]){
						content += '<img src="' + katPaths[i] + '" width = "20px" name="'+ katLabels[i] +'">'	
						
					}
					
				}
				
			}
			content += '<br>' + adresse + '</div>';
			
			
           infowindow.setContent(content);
              infowindow.open(map, this);
        });
		
	}
	
	
	
	function addPlace(place_id){
		/*service.getDetails({
          placeId: place_id
        }, function(place, status) {
          if (status === google.maps.places.PlacesServiceStatus.OK) {
            
			var marker = new google.maps.Marker({
              map: map,
              position: place.geometry.location
            });
			
			
            google.maps.event.addListener(marker, 'click', function() {
              infowindow.setContent('<div><strong>' + place.name + '</strong><br>' +
                'Place ID: ' + place.place_id + '<br>' +
                place.formatted_address + '</div>');
              infowindow.open(map, this);
         	 });
       	 }
        }
		);*/

		
	}
	
    
    function initMap() {
      var bremen = {lat: 53.076320, lng: 8.808581};
	 
		

	  
      map = new google.maps.Map(document.getElementById('map'), {
      		zoom: 12,
			minZoom: 10,
            center: bremen
       });
	   
	   infowindow = new google.maps.InfoWindow();
	   service = new google.maps.places.PlacesService(map);
	   
     /*  var marker = new google.maps.Marker({
           position: bremen,
           map: map
       });*/
	  
	   addPlace("ChIJxXW6Rq0psUcRN9scHRdPJ9Y");
	   //addPlace(name, spendenAnnahme, bGrad, lGrad, adresse)
		addPlace2("Verein für Innere Mission in Bremen",["Kleidung"],53.076420, 8.808581,"Blumenthalstraße 10");
		addPlace2("Hexe",["Kleidung"],53.076420, 8.805581,"Werder 2");
		
     }
	 
	 
	 //src: https://stackoverflow.com/questions/8354975/how-can-i-limit-possible-inputs-in-a-html5-number-element
	function maxLengthCheck(object) {
    if (object.value.length > object.maxLength)
      object.value = object.value.slice(0, object.maxLength)
  }
    
  function isNumeric (evt) {
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
    key = String.fromCharCode (key);
    var regex = /[0-9]|\./;
    if ( !regex.test(key) ) {
      theEvent.returnValue = false;
      if(theEvent.preventDefault) theEvent.preventDefault();
    }
  }
	 
	 
	 
         </script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiCHKIxpj5H2bfsFK5VRYI5al3r9ira2E&callback=initMap&libraries=places">
        </script>
</html>